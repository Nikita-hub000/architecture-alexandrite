# Планирование: анализ, идентификация проблем и поиск решений

## Существующие и потенциальные проблемные места

1. Производительность, надёжность и масштабируемость
   - Каждое приложение работает только на одном инстансе - нет отказоустойчивости и горизонтального масштабирования.
   - Каждая база данных работает на одном инстансе.
   - Отсутствует кеширование и прогрев кеша для часто читаемых списков и метаданных.
   - Внешние продавцы могут отправлять большое число запросов. Нет механизма backpressure
   - Проблемы в MES:
     - расчёт стоимости выполняется долго (для сложных 3D‑моделей — до 30 минут);
     - первая страница MES (дашборд) долго загружается.

2. Тестирование и релизный процесс
   - Увеличиваются задержки релизов.
   - Отсутствуют автоматические тесты — всё тестирование вручную.
   - Нет регулярного нагрузочного тестирования.

3. Наблюдаемость
   - Судя по всему, отсутствуют централизованные логи, метрики и трассировки - сложно локализовать сбои и задержки.

4. Организационные риски
   - Критический и нагруженный MES‑бэкенд написан на C# и поддерживается одним разработчиком.
   - Фронтенд MES на React имеет одного разработчика с частичной экспертизой в React.


## Инициативы для устранения проблем

1. Мониторинг, логирование и трейсинг
   - Внедрить централизованные логи, метрики и распределённые трассировки (Prometheus + OpenTelemetry).
   - Настроить алерты по ключевым метрикам (время расчёта, задержки очередей, ошибки API).

2. Оптимизация работы MES и БД
   - Добавить индексы в БД и профилировать медленные запросы.
   - Добавить реплики БД, настроенные только для чтения, чтобы снизить нагрузку с единственной БД и повысить отказоустойчивость.
   - Внедрить кеширование (Redis) для списков и метаданных.
   - Настроить read‑replicas для разгрузки чтений и повысить отказоустойчивость.
   - Масштабировать приложения (доп. инстансы, автоскейлинг, health checks).

3. Автоматизация тестирования и улучшение релизного процесса
   - Написать автотесты и интегрировать их в CI.
   - Настроить канареечный деплой для уменьшения риска при релизах.
   - Запустить регулярные нагрузочные тесты для расчёта цены и дашборда.

4. Асинхронизация расчёта стоимости
   - Вынести расчёт цены в отдельный worker‑сервис, работающий через очередь и масштабируемый горизонтально.

5. Backpressure и управление очередями
   - Реализовать паттерны backpressure при приёме внешних запросов.

6. Организационные изменения
   - Найм: минимум 1 C# разработчик, 1 React разработчик, 1 специалист по автоматизации тестирования.


## Три приоритетные инициативы на ближайшие полгода

1. Мониторинг, логирование и алертинг
   - Без наблюдаемости очень сложно вовремя обнаруживать и исправлять проблемы — это первая и обязательная задача для быстрой диагностики и реагирования.

2. Быстрая оптимизация БД и дашборда MES
   - Простые изменения (индексы, кеширование) дают быстрый выигрыш по времени отклика для операторов.

3. Асинхронный расчёт стоимости
   - Снимает основное горлышко (долгие расчеты) и защищает систему от перегрузок внешними клиентами.


## Дополнительно

Найм новых сотрудников следует вести параллельно с техническими инициативами — это не блокирует работу по пунктам 1–3, но снижает риск узкой экспертизы и ускоряет выполнение задач.

